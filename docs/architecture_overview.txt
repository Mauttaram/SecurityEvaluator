
╔═══════════════════════════════════════════════════════════════════════════╗
║                     SECURITY EVALUATOR ARCHITECTURE                       ║
╚═══════════════════════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────────────────────────────────┐
│  LAYER 1: USER INTERFACE                                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌──────────────────┐  ┌──────────────────┐  ┌──────────────────┐         │
│  │  Python API      │  │  CLI Tools       │  │  HTTP REST API   │         │
│  │                  │  │                  │  │                  │         │
│  │  create_         │  │  run_            │  │  POST /api/      │         │
│  │  ecosystem()     │  │  evaluation_     │  │  evaluate        │         │
│  │                  │  │  tests.py        │  │                  │         │
│  └────────┬─────────┘  └────────┬─────────┘  └────────┬─────────┘         │
│           │                     │                     │                    │
│           └─────────────────────┼─────────────────────┘                    │
└─────────────────────────────────┼──────────────────────────────────────────┘
                                  │
┌─────────────────────────────────┼──────────────────────────────────────────┐
│  LAYER 2: ORCHESTRATION          ▼                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌───────────────────────────────────────────────────────────────────────┐ │
│  │                      UNIFIED ECOSYSTEM                                │ │
│  │                                                                       │ │
│  │  ┌─────────────────────────────────────────────────────────────────┐ │ │
│  │  │                    META ORCHESTRATOR                            │ │ │
│  │  │                                                                 │ │ │
│  │  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │ │ │
│  │  │  │ Task Router  │  │ Coalition    │  │ Phase        │         │ │ │
│  │  │  │              │  │ Formation    │  │ Controller   │         │ │ │
│  │  │  └──────────────┘  └──────────────┘  └──────────────┘         │ │ │
│  │  └─────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                       │ │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐              │ │
│  │  │ Knowledge    │  │ Model        │  │ Cost         │              │ │
│  │  │ Base         │  │ Router       │  │ Optimizer    │              │ │
│  │  └──────────────┘  └──────────────┘  └──────────────┘              │ │
│  └───────────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────┼──────────────────────────────────────────┘
                                  │
┌─────────────────────────────────┼──────────────────────────────────────────┐
│  LAYER 3: AGENT COALITIONS       ▼                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────┐           │
│  │  🎯 ATTACK COALITION                                        │           │
│  │  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐   │           │
│  │  │ Boundary      │  │ Exploiter     │  │ Mutator       │   │           │
│  │  │ Prober        │  │ Agent         │  │ Agent         │   │           │
│  │  │ (Find weak    │  │ (Target       │  │ (Evolve       │   │           │
│  │  │  boundaries)  │  │  weaknesses)  │  │  attacks)     │   │           │
│  │  └───────────────┘  └───────────────┘  └───────────────┘   │           │
│  └─────────────────────────────────────────────────────────────┘           │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────┐           │
│  │  ✅ VALIDATION COALITION                                    │           │
│  │  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐   │           │
│  │  │ Validator     │  │ Perspective   │  │ LLM Judge     │   │           │
│  │  │ Agent         │  │ Agent         │  │ (Multi-LLM    │   │           │
│  │  │ (Filter       │  │ (Multi-view   │  │  Consensus)   │   │           │
│  │  │  unrealistic) │  │  assessment)  │  │               │   │           │
│  │  └───────────────┘  └───────────────┘  └───────────────┘   │           │
│  └─────────────────────────────────────────────────────────────┘           │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────┐           │
│  │  🔧 REMEDIATION COALITION                                   │           │
│  │  ┌──────────────────────────────────────────────────────┐   │           │
│  │  │ Counterfactual Agent (Generate fix suggestions)      │   │           │
│  │  └──────────────────────────────────────────────────────┘   │           │
│  └─────────────────────────────────────────────────────────────┘           │
└─────────────────────────────────┼──────────────────────────────────────────┘
                                  │
┌─────────────────────────────────┼──────────────────────────────────────────┐
│  LAYER 4: SECURITY SCENARIOS     ▼                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐   │
│  │ SQL          │  │ Prompt       │  │ Active       │  │ 50+ MITRE    │   │
│  │ Injection    │  │ Injection    │  │ Scanning     │  │ Scenarios    │   │
│  │              │  │              │  │ (T1595)      │  │ (Planned)    │   │
│  │ • 6 techs    │  │ • 7 techs    │  │ • 8 techs    │  │              │   │
│  │ • 3 mutators │  │ • 3 mutators │  │ • 4 mutators │  │              │   │
│  │ • 3 valids   │  │ • 2 valids   │  │ • 2 valids   │  │              │   │
│  └──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘   │
└─────────────────────────────────┼──────────────────────────────────────────┘
                                  │
┌─────────────────────────────────┼──────────────────────────────────────────┐
│  LAYER 5: EXTERNAL SERVICES      ▼                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐                  │
│  │ 🟢 OpenAI     │  │ 🟣 Anthropic  │  │ 🔵 Google     │                  │
│  │    GPT-4o     │  │    Claude 3.5 │  │    Gemini 2.0 │                  │
│  │    $0.15/1M   │  │    $3.00/1M   │  │    FREE       │                  │
│  └───────────────┘  └───────────────┘  └───────────────┘                  │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────┐           │
│  │ 🎯 PURPLE AGENT (System Under Test)                        │           │
│  │    Your security detection system being evaluated          │           │
│  └─────────────────────────────────────────────────────────────┘           │
└─────────────────────────────────────────────────────────────────────────────┘

KEY:
  🎯 Attack Coalition - Generates and evolves attacks
  ✅ Validation Coalition - Validates results and provides assessment
  🔧 Remediation Coalition - Suggests fixes
  🟢🟣🔵 LLM Providers - Optional multi-LLM consensus
